# .NET 域账户验证
[2014-12-07 22:24:11](#data.create_time)<br/>
[这个程序就是要遍历一下winNT系统的域名列表啊。](#data.description)

winnt http://technet.microsoft.com/zh-cn/library/cc755763(WS.10).aspx <br/>
WinNT://Domain是NT系统下面的domain（域名），这个程序就是要遍历一下winNT系统的域名列表啊。<br/> 
LDAP http://baike.baidu.com/view/159263.htm <br/>
需要为项目添加引用:
```c#
System.DirectoryServices.dll DirectoryEntry de = new DirectoryEntry("WinNT://py");
      foreach (DirectoryEntry ch in de.Children) { 
      Console.WriteLine(ch.Name); 
   }
```
 
//py是我们公司的域，这代码获取所有用户，为什么要用WinNT:\\py而不能用ldap:\\py。<br/>
怎么找到哪些域用户属于哪些组，哪些域用户被禁用了。 问题补充： Path 属性的语法随提供程序不同而不同。<br/>
一些常见的情况有： <br/>
WinNT 连接到计算机上的组。例如“WinNT:////”。 如果是连接到本地计算机，则为“WinNT:///”。 <br/>
连接到计算机上的用户。例如“WinNT:////”。 如果是连接到本地计算机，则为“WinNT:///”。 <br/>
连接到计算机上的服务。例如“WinNT:////”。 如果是连接到本地计算机，则为“WinNT:///”。 <br/>
发现网络上的所有域。例如，“WinNT:”通过枚举此项的子级可以找到这些域。 <br/>
LDAP 连接到域中的组。例如“LDAP://CN=, CN =, DC=, DC=,...”。 <br/>
连接到域中的用户。例如“LDAP://CN=, CN=, DC=, DC=,...”。 <br/>
连接到域中的计算机。例如“LDAP://CN=, CN=, DC=, DC=,...”。 <br/>
IIS连接到Web目录。例如“IIS://LocalHost/W3SVC/1/ROOT/”。 <br/>
若要使用 LDAP 绑定到当前域，请使用路径“LDAP://RootDSE”，然后获取默认命名上下文，并重新绑定该项。<br/>
 ```c#
bool ret = false;
            string _path = "WinNT://ESN.ORG";
            DirectoryEntry entry = new DirectoryEntry(_path, UserId, Password, 

AuthenticationTypes.ServerBind);
            try
            {
                object obj = entry.NativeObject;
                string name = entry.Name;
                ret = true;
            }
            catch
            {
                //登录AD服务器失败
            }
            finally
            {
                entry.Close();
                entry.Dispose();
            } 
```

